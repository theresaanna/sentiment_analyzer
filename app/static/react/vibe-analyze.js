import{c as Ce,j as Ee,r as Te}from"./chunks/client-DXcH-vAE.js";function _e(){return Te.useEffect(()=>{const b=document.getElementById("react-analyze-root");if(!b)return;const v=b.getAttribute("data-video-id")||"",q=(b.getAttribute("data-is-auth")||"false")==="true",Y=(b.getAttribute("data-is-pro")||"false")==="true";parseInt(b.getAttribute("data-video-comments")||"0",10);let p;try{p=JSON.parse(b.getAttribute("data-comment-stats")||"{}")}catch{p={}}let h;try{h=JSON.parse(b.getAttribute("data-precomputed-results")||"null")}catch{h=null}let j;try{j=JSON.parse(b.getAttribute("data-updated-stats")||"null")}catch{j=null}let T=null,A=null,$={},P={positive:[],neutral:[],negative:[]},w=null,D=0,x=null,O=0,B=0,L=0,S=null;window.submitFeedback=be,window.showLoginPrompt=Ie,window.showProUpgradePrompt=Se,window.startSentimentAnalysis=R,window.isAuthenticated=q,window.isProUser=Y;const de=Number((p==null?void 0:p.top_level_count)||0),U=Number((p==null?void 0:p.total_top_level_comments)||(p==null?void 0:p.total_available)||0)||de||5e3;if(window.currentTotalComments=U,h){const e=document.getElementById("sentimentAnalysisSection"),n=document.getElementById("analysisProgress"),s=document.getElementById("analysisResults");e&&(e.style.display="block",e.classList.add("active")),n&&(n.style.display="none"),s&&(s.style.display="block");const i={sentiment:{overall_sentiment:h.overall_sentiment||"neutral",distribution:h.distribution||{positive:0,neutral:0,negative:0},distribution_percentage:h.percentages||{positive:0,neutral:0,negative:0},sentiment_counts:h.distribution||{positive:0,neutral:0,negative:0},sentiment_percentages:h.percentages||{positive:0,neutral:0,negative:0},average_confidence:h.average_confidence||0,sentiment_score:h.sentiment_score||0,total_analyzed:h.total_analyzed||0,individual_results:h.individual_results||[],model:h.model||"enhanced-sentiment-v1"},summary:{summary:h.summary||"Analysis completed successfully."}};ie(i),j&&re(j);const t=document.getElementById("sampleCommentsSection");t&&(t.style.display="block")}(async()=>await we())();const K=document.getElementById("startSentimentAnalysis");K&&K.addEventListener("click",R);const _=document.getElementById("instantSlider"),y=document.getElementById("queueSlider"),V=document.getElementById("instantValue"),G=document.getElementById("queueValue"),Z=document.getElementById("instantCoverage"),X=document.getElementById("queueCoverage"),ee=document.getElementById("instantAnalyzeBtn"),J=document.getElementById("queueAnalyzeBtn");ue(),_&&(_.addEventListener("input",H),_.addEventListener("change",H),H()),y&&(y.addEventListener("input",N),y.addEventListener("change",N),N());const te=document.getElementById("instant-tab"),ne=document.getElementById("queue-tab");te&&te.addEventListener("shown.bs.tab",()=>{const e=document.getElementById("analysisTypeHeader");e&&(e.textContent="Instant Analysis"),H()}),ne&&ne.addEventListener("shown.bs.tab",()=>{const e=document.getElementById("queueAnalysisHeader");e&&(e.textContent="Queue Analysis"),N()}),ee&&ee.addEventListener("click",e=>{e.preventDefault();const n=parseInt(_&&_.value||"100",10);se("instant",n)}),J&&J.addEventListener("click",e=>{e.preventDefault();const n=parseInt(y&&y.value||"1000",10);se("queue",n)});function ue(){const e=window.currentTotalComments||U;if(_){const n=Math.min(500,e);_.max=String(n);const s=document.getElementById("instantMax");s&&(s.textContent=String(n)),H()}if(y&&q){const n=Math.min(Y?5e3:2500,e);y.max=String(n),y.min="1",n<100?(y.value=String(Math.min(n,10)),y.step="1"):n<1e3?(y.value=String(Math.min(100,n)),y.step="10"):(y.value="1000",y.step="10");const s=document.getElementById("queueMax");s&&(n<1e3?s.textContent=String(n):s.textContent=`${(n/1e3).toFixed(1).replace(".0","")}k`),N()}}function H(){if(!_)return;const e=parseInt(_.value||"0",10),n=window.currentTotalComments||U,s=Math.min(100,Math.round(e/n*100));V&&(V.textContent=String(e)),Z&&(Z.textContent=`${s}%`);const i=e<=100?"~5s":e<=300?"~15s":"~30s",t=document.querySelector("#instant .analysis-stats .stat-item:nth-child(2) strong");t&&(t.textContent=i)}function N(){if(!y)return;const e=parseInt(y.value||"1",10),n=window.currentTotalComments||U,s=Math.min(100,Math.round(e/n*100));G&&(G.textContent=e<1e3?String(e):e.toLocaleString()),X&&(X.textContent=`${s}%`);const i=Math.round(e*.12),t=document.querySelector("#queue .analysis-stats .stat-item:nth-child(2) strong");t&&(t.textContent=i<60?`~${i}s`:`~${Math.round(i/60)} min`)}function se(e,n){if(e==="queue"){if(!q){M("Please sign in to use Queue mode","warning"),typeof window.showLoginPrompt=="function"&&window.showLoginPrompt();return}const s=J;s&&(s.disabled=!0,s.innerHTML='<i class="fas fa-spinner fa-spin"></i> Queueing...'),fetch("/api/analyze/queue",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({video_id:v,comment_count:n,include_replies:!1})}).then(i=>i.json()).then(i=>{if(i.success){const t=Math.round(n/100*1.5/60),a=t>1?`${t} minutes`:"1 minute";M(`Analysis queued! Estimated time: ~${a}`,"success"),setTimeout(()=>{window.location.href=`/analysis/${i.job_id}`},1500)}else M(`Error: ${i.error}`,"danger"),s&&(s.disabled=!1,s.innerHTML='<i class="fas fa-clock"></i> Queue Analysis')}).catch(i=>{console.error("Error queueing analysis:",i),M("Failed to queue analysis","danger"),s&&(s.disabled=!1,s.innerHTML='<i class="fas fa-clock"></i> Queue Analysis')})}else{const s=document.getElementById("sentimentAnalysisSection"),i=document.getElementById("analysisProgress"),t=document.getElementById("analysisResults");s&&(s.style.display="block",s.classList.add("active")),i&&(i.style.display="flex"),t&&(t.style.display="none"),ae(v,n,Math.round(n/(window.currentTotalComments||5e3)*100))}}function R(){const e=document.getElementById("instantSlider"),n=parseInt(e&&e.value||"100",10);w&&clearInterval(w),x&&clearInterval(x),S&&cancelAnimationFrame(S),B=0,L=0,D=0,O=0;const s=document.getElementById("sentimentAnalysisSection"),i=document.getElementById("analysisProgress"),t=document.getElementById("analysisResults"),a=document.getElementById("analysisActionButton");Number((p==null?void 0:p.total_available)||0),Number((p==null?void 0:p.total_comments)||0);let o=Math.min(n,q?Y?5e3:2500:500);o=Math.max(o,5),s&&(s.style.display="block",s.classList.add("active")),i&&(i.style.display="flex"),t&&(t.style.display="none");const l=document.getElementById("funFactText");l&&(l.textContent=W[0]),a&&(a.disabled=!0,a.innerHTML='<i class="fas fa-spinner fa-spin"></i> Analyzing...'),s==null||s.scrollIntoView({behavior:"smooth",block:"start"});const r=Math.round(o/(window.currentTotalComments||5e3)*100);ae(v,o,r)}function ae(e,n,s){fetch(`/api/analyze/sentiment/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({max_comments:n,percentage_selected:s,include_replies:!1})}).then(t=>t.status===507?(C("The analysis cache is currently full. Please wait a moment while we clear some space and try again."),setTimeout(()=>{C("Retrying analysis..."),R()},3e3),null):t.json()).then(t=>{t&&(t.success?(T=t.analysis_id,t.cached?Q():A=setInterval(me,1e3)):C(t.error||"Failed to start analysis"))}).catch(t=>C("Failed to start analysis: "+t))}function me(){T&&fetch(`/api/analyze/status/${T}`).then(e=>e.json()).then(e=>{e.success?(ge(e.status),e.status.status==="completed"?(clearInterval(A),Q()):e.status.status==="error"&&(clearInterval(A),C(e.status.error))):!e.success&&e.error==="Analysis not found"&&(clearInterval(A),C("Analysis data was cleared. Restarting..."),T=null,setTimeout(()=>R(),1500))}).catch(e=>console.error("Status check error:",e))}function Q(){T&&fetch(`/api/analyze/results/${T}`).then(e=>e.json()).then(e=>{e.success?ie(e.results):e.restart_needed||e.error&&e.error.includes("Analysis not found")?(C("This analysis has expired or been cleared. Starting a new analysis..."),T=null,setTimeout(()=>{const n=document.getElementById("analysisProgress"),s=document.getElementById("analysisResults");n&&(n.style.display="flex"),s&&(s.style.display="none"),R()},1500)):C(e.error+(e.details?": "+e.details:""))}).catch(e=>C("Failed to fetch results: "+e))}function ge(e){const n=document.getElementById("progressBar"),s=document.getElementById("progressText"),i=document.getElementById("progressStatus"),t=document.getElementById("progressSubStatus"),a=document.getElementById("progressDetail"),o=document.getElementById("funFactText");L=e.progress||0;const l=()=>{Math.abs(B-L)>.5?(B+=(L-B)*.1,n&&(n.style.width=B+"%"),s&&(s.textContent=String(Math.round(B))+"%"),S=requestAnimationFrame(l)):(B=L,n&&(n.style.width=L+"%"),s&&(s.textContent=String(Math.round(L))+"%"))};S&&cancelAnimationFrame(S),l();let r="Initializing vibe check...",c="",m=[];switch(e.status){case"fetching_comments":r="Downloading Comments",c=z.fetching_comments[0],m=z.fetching_comments,a&&(a.textContent=`${e.current||0} fetched`);break;case"using_cached":r="Loading Cached Data",c="Retrieving pre-analyzed vibes...",a&&(a.textContent="Fast mode activated");break;case"analyzing_sentiment":r="Analyzing Sentiment",c=z.analyzing_sentiment[0],m=z.analyzing_sentiment,a&&(a.textContent=`${e.current||0}/${e.total||0} comments`);break;case"generating_summary":r="Generating Insights",c=z.generating_summary[0],m=z.generating_summary,a&&(a.textContent="Almost there!");break;case"completed":r="✨ Analysis Complete!",c="Your results are ready!",a&&(a.textContent=""),w&&clearInterval(w),x&&clearInterval(x);break}i&&(i.textContent=r),t&&(t.textContent=c),m.length>0&&e.status!=="completed"&&(w&&clearInterval(w),D=0,w=setInterval(()=>{D=(D+1)%m.length,t&&(t.textContent=m[D],t.style.animation="none",setTimeout(()=>{t.style.animation="fadeInOut 4s ease-in-out infinite"},10))},3e3)),!x&&e.status!=="completed"&&o&&(x=setInterval(()=>{O=(O+1)%W.length,o.style.opacity="0",setTimeout(()=>{o.textContent=W[O],o.style.opacity="1"},300)},5e3))}function fe(){if(!T)return;const e=document.getElementById("aiSummary");e&&(e.innerHTML='<p>Retrying summary... <i class="fas fa-spinner fa-spin"></i></p>'),fetch(`/api/analyze/retry-summary/${T}`,{method:"POST"}).then(n=>n.json()).then(n=>{n.success&&n.summary&&n.summary.summary&&Q()}).catch(n=>{e&&(e.innerHTML=`<p>Summary retry failed: ${n}</p>`)})}function ie(e){const n=document.getElementById("analysisProgress"),s=document.getElementById("analysisResults"),i=document.getElementById("sampleCommentsSection"),t=document.getElementById("startSentimentAnalysis");if(!e||!e.sentiment){C("No results returned. Please try again.");return}n&&(n.style.display="none"),s&&(s.style.display="block"),i&&(i.style.display="block"),t&&(t.innerHTML='<i class="fas fa-sync"></i> Re-analyze',t.disabled=!1);const a=e.sentiment,o=document.getElementById("overallSentiment");let l="neutral",r=50;if(a.distribution){const d=a.distribution.positive||0,u=a.distribution.negative||0,g=a.distribution.neutral||0,E=d+u+g;E>0&&(r=(d-u)/E*50+50,d>u&&d>g?l="positive":u>d&&u>g?l="negative":l="neutral")}const c=typeof a.average_confidence=="number"?a.average_confidence:0,m=c>1?c.toFixed(1):(c*100).toFixed(1),I=a.total_analyzed||(Array.isArray(a.individual_results)?a.individual_results.length:0);o&&(o.innerHTML=`
          <strong>${l.charAt(0).toUpperCase()+l.slice(1)}</strong>
          (Score: ${r.toFixed(1)}%, Confidence: ${m}%)<br>
          <small>Analyzed ${I} comments using advanced sentiment analysis</small>
        `);const k=document.getElementById("aiSummary"),f=e.summary;if(k&&f)if(f.summary)k.innerHTML=`<p>${f.summary}</p>`;else{k.innerHTML='<p>Summary not available. <a href="#" id="retrySummaryLink">Try again</a></p>';const d=document.getElementById("retrySummaryLink");d&&d.addEventListener("click",u=>{u.preventDefault(),d.innerHTML='Retrying... <i class="fas fa-spinner fa-spin"></i>',fe()})}setTimeout(()=>{var d;try{pe(a)}catch(u){console.error("pie chart error",u)}try{let u=e.timeline;if((!u||u.length===0)&&a.individual_results&&a.individual_results.length>0&&(u=a.individual_results.map((g,E)=>({sentiment:g.predicted_sentiment||g.sentiment||"neutral",score:g.sentiment_scores||{positive:g.predicted_sentiment==="positive"?.8:.1,neutral:g.predicted_sentiment==="neutral"?.8:.1,negative:g.predicted_sentiment==="negative"?.8:.1},text_preview:(g.text||"").substring(0,100),index:E}))),u&&u.length>0)ye(u);else{const g=(d=document.querySelector("#sentimentTimelineChart"))==null?void 0:d.closest(".card");g&&(g.style.display="none")}}catch(u){console.error("timeline chart error",u)}},300);try{he(a.individual_results||[])}catch(d){console.error("sample comments error",d)}e.updated_stats&&re(e.updated_stats)}function pe(e){const n=document.getElementById("sentimentPieChart");if(!n||!window.Chart)return;const s=n.getContext("2d");$.pie&&$.pie.destroy();const i=e.sentiment_counts||e.distribution||{positive:0,neutral:0,negative:0};$.pie=new window.Chart(s,{type:"doughnut",data:{labels:["Positive","Neutral","Negative"],datasets:[{data:[i.positive||0,i.neutral||0,i.negative||0],backgroundColor:["rgba(209,231,221,0.9)","rgba(206,212,218,0.9)","rgba(227,93,106,0.85)"],borderColor:["rgba(25,135,84,1)","rgba(160,165,170,1)","rgba(176,42,55,1)"],borderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},tooltip:{callbacks:{label:t=>{const a=t.label||"",o=t.parsed||0,l=t.dataset.data.reduce((c,m)=>c+m,0),r=l?(o/l*100).toFixed(1):"0.0";return`${a}: ${o} (${r}%)`}}}}}})}function ye(e){const n=document.getElementById("sentimentTimelineChart");if(!n||!window.Chart)return;const s=n.getContext("2d");if($.timeline&&$.timeline.destroy(),!e||e.length===0){const c=n.closest(".card");if(c){const m=c.querySelector(".card-body");m&&(m.innerHTML='<p class="text-muted text-center py-3">Timeline data not available for this analysis</p>')}return}const i=[],t=Math.max(1,Math.ceil(e.length/20));for(let c=0;c<e.length;c+=t){const m=e.slice(c,Math.min(c+t,e.length));let I=0,k=0,f=0,d=0;m.forEach(g=>{let F=g.score||g.sentiment_scores||{};if(!F||Object.keys(F).length===0){const ce=g.sentiment||g.predicted_sentiment||"neutral";F=ce==="positive"?{positive:.8,neutral:.15,negative:.05}:ce==="negative"?{positive:.05,neutral:.15,negative:.8}:{positive:.1,neutral:.8,negative:.1}}I+=F.positive||0,k+=F.neutral||0,f+=F.negative||0,d++});const u=Math.max(d,1);i.push({positive:I/u*100,neutral:k/u*100,negative:f/u*100,index:c})}const a=[],o=[],l=[],r=[];i.forEach((c,m)=>{const I=c.index/e.length*100;m===0?a.push("Early"):m===i.length-1?a.push("Recent"):Math.abs(I-25)<5?a.push("25%"):Math.abs(I-50)<5?a.push("Midpoint"):Math.abs(I-75)<5?a.push("75%"):a.push(`${Math.round(I)}%`),o.push(c.positive),l.push(c.neutral),r.push(c.negative)}),$.timeline=new window.Chart(s,{type:"line",data:{labels:a,datasets:[{label:"Positive",data:o,borderColor:"rgba(25,135,84,1)",backgroundColor:"rgba(209,231,221,0.35)",tension:.4},{label:"Neutral",data:l,borderColor:"rgba(160,165,170,1)",backgroundColor:"rgba(206,212,218,0.35)",tension:.4},{label:"Negative",data:r,borderColor:"rgba(176,42,55,1)",backgroundColor:"rgba(227,93,106,0.25)",tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{title:{display:!0,text:"Comment Timeline (Early → Recent)",font:{size:12}},ticks:{autoSkip:!1,maxRotation:0,font:{size:11}}},y:{beginAtZero:!0,max:100,title:{display:!0,text:"Sentiment Score",font:{size:12}},ticks:{callback:c=>`${c}%`}}},interaction:{mode:"index",intersect:!1},plugins:{legend:{position:"bottom"}}}})}function he(e){if(!e||!Array.isArray(e))return;const n=[],s=[],i=[];e.forEach(o=>{const l={text:o.text||"",confidence:(typeof o.confidence=="number"?o.confidence>1?o.confidence:o.confidence*100:0).toFixed(1),commentId:o.commentId||o.comment_id||null,author:o.author||"Anonymous"},r=o.predicted_sentiment||o.sentiment;r==="positive"?n.push(l):r==="neutral"?s.push(l):r==="negative"&&i.push(l)}),n.sort((o,l)=>parseFloat(l.confidence)-parseFloat(o.confidence)),s.sort((o,l)=>parseFloat(l.confidence)-parseFloat(o.confidence)),i.sort((o,l)=>parseFloat(l.confidence)-parseFloat(o.confidence)),(()=>{const o=(l,r)=>{const c=document.getElementById(l);c&&(c.textContent=String(r))};o("positiveCount",n.length),o("neutralCount",s.length),o("negativeCount",i.length)})();const a=(o,l,r)=>{const c=document.getElementById(l);if(!c)return;if(o.length===0){c.innerHTML='<p class="text-muted text-center py-3">No samples available</p>';return}const m=Math.min(o.length,50),I=(f,d=300)=>f.length<=d?f:f.substring(0,d)+"...",k=f=>f.replace(/[&<>"']/g,d=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"})[d]);c.innerHTML=o.slice(0,m).map((f,d)=>{const u=k(I(f.text)),g=parseFloat(f.confidence)>=80?"success":parseFloat(f.confidence)>=60?"warning":"secondary",E=`comment-${r}-${d}`;return`
            <div class="comment-sample-item ${r}" id="${E}" data-comment-index="${d}">
              <div class="comment-sample-text">${u}</div>
              <div class="comment-sample-meta">
                <span class="text-muted"><i class="fas fa-user-circle"></i> ${k((f.author||"Anonymous").substring(0,20))}</span>
                <span class="confidence-badge bg-${g}">${f.confidence}%</span>
              </div>
              <div class="feedback-buttons">
                <span class="text-muted" style="font-size: 0.7rem; margin-right: 8px;">AI thinks:</span>
                <button class="feedback-btn positive ${r==="positive"?"current-sentiment":""}" ${r==="positive"?"disabled":""} onclick="submitFeedback('${E}', '${r}', 'positive', ${d})">👍 Positive</button>
                <button class="feedback-btn neutral ${r==="neutral"?"current-sentiment":""}" ${r==="neutral"?"disabled":""} onclick="submitFeedback('${E}', '${r}', 'neutral', ${d})">👐 Neutral</button>
                <button class="feedback-btn negative ${r==="negative"?"current-sentiment":""}" ${r==="negative"?"disabled":""} onclick="submitFeedback('${E}', '${r}', 'negative', ${d})">👎 Negative</button>
              </div>
            </div>
          `}).join(""),o.length>m&&(c.innerHTML+=`<div class="text-center text-muted py-2"><small><i class="fas fa-info-circle"></i> Showing ${m} of ${o.length} ${r} comments</small></div>`)};P.positive=n,P.neutral=s,P.negative=i,a(n,"positiveSamples","positive"),a(s,"neutralSamples","neutral"),a(i,"negativeSamples","negative"),setTimeout(xe,100)}async function be(e,n,s,i){if(n===s)return;const t=document.getElementById(e),a=(P[n]||[])[i];if(a)try{const o=(t==null?void 0:t.querySelectorAll(".feedback-btn"))||[];o.forEach(c=>c.disabled=!0);const r=await(await fetch("/api/sentiment-feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({video_id:v,comment_id:a.commentId,comment_text:a.text,comment_author:a.author,predicted_sentiment:n,corrected_sentiment:s,confidence_score:parseFloat(a.confidence)/100})})).json();r.success?(M(r.message||"Thank you for your feedback!","success",3e3),oe(t,n,s),ve(a.text,n,s)):(o.forEach(c=>c.disabled=!1),r.error&&r.error.includes("already submitted")?M("You've already provided feedback for this comment","info"):M(r.error||"Failed to submit feedback","warning"))}catch(o){console.error("Error submitting feedback:",o),M("Failed to submit feedback. Please try again.","danger"),((t==null?void 0:t.querySelectorAll(".feedback-btn"))||[]).forEach(r=>r.disabled=!1)}}function oe(e,n,s){if(!e)return;if(e.classList.add("manually-corrected"),!e.querySelector(".manual-correction-badge")){const t=document.createElement("div");t.className="manual-correction-badge",t.innerHTML='<i class="fas fa-user-check"></i> Manually Corrected',e.appendChild(t)}if(e.querySelectorAll(".feedback-btn").forEach(t=>{t.disabled=!0,t.classList.remove("current-sentiment","highlighted-correction","disabled-original"),t.classList.contains(n)?t.classList.add("disabled-original"):t.classList.contains(s)&&t.classList.add("highlighted-correction")}),!e.querySelector(".correction-info")){const t=document.createElement("div");t.className="correction-info",t.innerHTML=`
          <i class="fas fa-info-circle"></i>
          <span class="original-prediction">AI predicted: ${le(n)}</span>
          <span class="user-correction">→ You corrected to: ${le(s)}</span>
        `,e.appendChild(t)}}function ve(e,n,s){const i=`sentiment_corrections_${v}`;let t={};try{t=JSON.parse(localStorage.getItem(i)||"{}")}catch{t={}}const a=(e||"").substring(0,100);t[a]={original:n,corrected:s,timestamp:new Date().toISOString()},localStorage.setItem(i,JSON.stringify(t))}async function we(){try{const n=await(await fetch(`/api/sentiment-feedback?video_id=${v}`)).json();if(n.success&&n.feedback.length>0){const s=`sentiment_corrections_${v}`,i={};return n.feedback.forEach(t=>{const a=(t.comment_text||"").substring(0,100);i[a]={original:t.predicted_sentiment,corrected:t.corrected_sentiment,timestamp:t.created_at}}),localStorage.setItem(s,JSON.stringify(i)),i}}catch(e){console.error("Error loading user feedback:",e)}return{}}function xe(){const e=`sentiment_corrections_${v}`;let n={};try{n=JSON.parse(localStorage.getItem(e)||"{}")}catch{n={}}Object.keys(P).forEach(s=>{(P[s]||[]).forEach((i,t)=>{const a=(i.text||"").substring(0,100),o=n[a];if(o){const l=`comment-${s}-${t}`,r=document.getElementById(l);r&&oe(r,o.original,o.corrected)}})})}function re(e){if(!e)return;const n=document.querySelectorAll(".card-header-vibe h3"),s=n&&n[1];if(s&&!s.querySelector(".updated-badge")){const a=document.createElement("span");a.className="badge badge-success ml-2 updated-badge",a.textContent="Updated",a.style.fontSize="0.6em",a.style.verticalAlign="middle",a.style.animation="fadeIn 0.5s",s.appendChild(a)}const i=document.querySelector(".alert-info");i&&e.total_analyzed&&(i.innerHTML=`
          <i class="fas fa-info-circle"></i>
          <strong>Analysis Updated:</strong> Analyzed <strong>${e.total_analyzed}</strong> comments
          (<strong>${e.analysis_depth_percentage}%</strong> of total available)<br>
          <small class="text-muted"><i class="fas fa-chart-line"></i> Statistics below reflect the expanded analysis dataset</small>
        `,i.classList.add("alert-success"),i.classList.remove("alert-info"));const t=document.querySelector(".comment-stats-grid");if(t){const a=t.querySelector(".stat-item:nth-child(1) .stat-value");a&&(a.textContent=String(e.unique_commenters||0));const o=t.querySelector(".stat-item:nth-child(2) .stat-value");o&&(o.textContent=String(e.avg_comment_length||0));const l=t.querySelector(".stat-item:nth-child(3) .stat-value");l&&(l.textContent=String(e.top_level_count||0));const r=t.querySelector(".stat-item:nth-child(4) .stat-value");r&&(r.textContent=String(e.replies_count||0))}if(e.top_commenters&&e.top_commenters.length>0){const a=document.querySelector(".list-group-flush");a&&(a.innerHTML="",e.top_commenters.forEach((o,l)=>{const r=document.createElement("li");r.className="list-group-item d-flex justify-content-between align-items-center",r.innerHTML=`<span><strong>#${l+1}</strong> ${o[0]}</span><span class="badge badge-primary badge-pill">${o[1]} comments</span>`,a.appendChild(r)}))}}function M(e,n="info",s=3e3){let i=document.getElementById("toastContainer");i||(i=document.createElement("div"),i.id="toastContainer",i.style.cssText="position: fixed; top: 20px; right: 20px; z-index: 9999;",document.body.appendChild(i));const t=document.createElement("div"),a=n==="success"?"success":n==="danger"?"danger":n==="warning"?"warning":"info";t.className=`alert alert-${a} alert-dismissible fade show`,t.style.cssText="min-width: 250px; margin-bottom: 10px; animation: slideIn 0.3s ease-out;",t.setAttribute("role","alert");const o=n==="success"?"✓":n==="danger"?"✕":n==="warning"?"⚠":"ℹ";t.innerHTML=`<strong>${o}</strong> ${e}<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>`,i.appendChild(t),setTimeout(()=>{t.classList.remove("show"),setTimeout(()=>t.remove(),150)},s)}function C(e){const n=document.getElementById("analysisProgress"),s=document.getElementById("startSentimentAnalysis");w&&(clearInterval(w),w=null),x&&(clearInterval(x),x=null),S&&(cancelAnimationFrame(S),S=null);let i="Oops! Something went wrong",t=e||"Unknown error",a="fas fa-exclamation-triangle",o=[];const l=String(e||"").toLowerCase();l.includes("unfinished")||l.includes("timeout")?(i="Analysis Timeout",a="fas fa-clock",t="The analysis is taking longer than expected. This usually happens when processing many comments.",o=["Try analyzing fewer comments","Wait a moment for the service to recover","Try again in a few minutes"]):l.includes("memory")||l.includes("cache")?(i="Service Temporarily Busy",a="fas fa-server",t="Our servers are experiencing high demand right now.",o=["Please wait and try again","Consider analyzing fewer comments","Try during off-peak hours"]):l.includes("not found")?(i="Analysis Not Found",a="fas fa-search",t="The analysis results couldn't be found. They may have expired.",o=["Start a fresh analysis","Make sure you haven't waited too long"]):l.includes("network")||l.includes("fetch")?(i="Connection Issue",a="fas fa-wifi",t="There was a problem connecting to our analysis service.",o=["Check your internet","Refresh the page","Disable any blockers that might interfere"]):(l.includes("high load")||l.includes("service"))&&(i="Service Under Load",a="fas fa-chart-line",t="Our sentiment analysis service is experiencing high demand.",o=["Try with fewer comments","Wait a few minutes","Consider queue option if available"]);const r=o.length>0?`<div class="mt-3"><h6 class="font-weight-bold">What you can try:</h6><ul class="mb-0">${o.map(c=>`<li>${c}</li>`).join("")}</ul></div>`:"";n&&(n.innerHTML=`
          <div class="error-container animated fadeIn">
            <div class="alert alert-danger border-0 shadow-sm" style="border-radius:12px; background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);">
              <div class="d-flex align-items-start">
                <div class="error-icon-wrapper mr-3" style="font-size:2rem; color:#dc2626;"><i class="${a}"></i></div>
                <div class="flex-grow-1">
                  <h5 class="alert-heading mb-2" style="color:#991b1b;">${i}</h5>
                  <p class="mb-0" style="color:#7f1d1d;">${t}</p>
                  ${r}
                  <details class="mt-3"><summary style="cursor:pointer; color:#991b1b; font-size:0.85rem;"><i class="fas fa-bug"></i> Technical details</summary><pre class="mt-2 p-2 bg-white rounded" style="font-size:0.75rem; color:#6b7280; max-height:100px; overflow-y:auto;">${e}</pre></details>
                </div>
              </div>
            </div>
            <div class="text-center mt-3">
              <button class="btn btn-lg" onclick="location.reload()" style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; border-radius:25px; padding:12px 30px; border:none; box-shadow:0 4px 15px rgba(102,126,234,0.4);"> <i class="fas fa-redo mr-2"></i> Refresh & Try Again</button>
            </div>
          </div>
        `),s&&(s.innerHTML='<i class="fas fa-brain"></i> Retry Analysis',s.disabled=!1),A&&clearInterval(A)}function Ie(){const e=document.getElementById("loginPromptModal");e&&e.remove(),document.body.insertAdjacentHTML("beforeend",`
        <div class="modal fade" id="loginPromptModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius:15px; border:none; box-shadow:0 10px 30px rgba(0,0,0,0.2);">
              <div class="modal-header" style="background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; border-radius:15px 15px 0 0;">
                <h5 class="modal-title"><i class="fas fa-sign-in-alt mr-2"></i>Sign In Required</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: brightness(0) invert(1); opacity: 0.8;"></button>
              </div>
              <div class="modal-body text-center" style="padding:2rem;">
                <div class="mb-3"><i class="fas fa-lock" style="font-size:3rem; color:#667eea; opacity:0.7;"></i></div>
                <h5 class="mb-3">Want to analyze more comments?</h5>
                <p class="text-muted mb-4">Sign in to queue analysis jobs and analyze up to 2,500 comments!</p>
                <div class="mb-3">
                  <div class="alert alert-info" style="border-radius: 10px;">
                    <strong>Free Account Benefits:</strong><br>
                    <small>✓ Analyze up to 2,500 comments<br>✓ Queue background jobs<br>✓ Save analysis history<br>✓ Export results</small>
                  </div>
                </div>
              </div>
              <div class="modal-footer" style="border-top:none; padding:0 2rem 2rem 2rem;">
                <a href="/login" class="btn btn-primary btn-lg" style="border-radius:25px; width:100%; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); border:none;"><i class="fas fa-sign-in-alt mr-2"></i>Sign In for Free Analysis</a>
                <div class="text-center mt-2"><small class="text-muted">Don't have an account? <a href="/register" class="text-primary">Create one free</a></small></div>
              </div>
            </div>
          </div>
        </div>`),window.bootstrap&&new window.bootstrap.Modal(document.getElementById("loginPromptModal")).show()}function Se(){const e=document.getElementById("proUpgradePromptModal");e&&e.remove(),document.body.insertAdjacentHTML("beforeend",`
        <div class="modal fade" id="proUpgradePromptModal" tabindex="-1" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius:15px; border:none; box-shadow:0 10px 30px rgba(0,0,0,0.2);">
              <div class="modal-header" style="background:linear-gradient(135deg,#f59e0b 0%, #d97706 100%); color:white; border-radius:15px 15px 0 0;">
                <h5 class="modal-title"><i class="fas fa-crown mr-2"></i>Upgrade to Pro</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style="filter: brightness(0) invert(1); opacity: 0.8;"></button>
              </div>
              <div class="modal-body text-center" style="padding:2rem;">
                <div class="mb-3"><i class="fas fa-star" style="font-size:3rem; color:#f59e0b;"></i></div>
                <h5 class="mb-3">Unlock Advanced Analysis</h5>
                <p class="text-muted mb-4">Upgrade to Pro to analyze up to 5,000 comments!</p>
                <div class="mb-3">
                  <div class="alert alert-warning" style="border-radius: 10px; background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); border: none;">
                    <strong>Pro Account Benefits:</strong><br>
                    <small style="color:#92400e;">✓ Analyze up to 5,000 comments<br>✓ Process entire videos<br>✓ Advanced filtering options<br>✓ Priority processing<br>✓ Detailed analytics reports</small>
                  </div>
                </div>
              </div>
              <div class="modal-footer" style="border-top:none; padding:0 2rem 2rem 2rem;">
                <a href="/subscribe" class="btn btn-warning btn-lg" style="border-radius:25px; width:100%; background:linear-gradient(135deg,#f59e0b 0%, #d97706 100%); border:none; color:white;"><i class="fas fa-crown mr-2"></i>Upgrade to Pro</a>
                <div class="text-center mt-2"><small class="text-muted"><a href="#" class="text-warning" data-bs-dismiss="modal">Maybe later</a></small></div>
              </div>
            </div>
          </div>
        </div>`),window.bootstrap&&new window.bootstrap.Modal(document.getElementById("proUpgradePromptModal")).show()}function le(e){return(e||"").charAt(0).toUpperCase()+(e||"").slice(1)}const z={fetching_comments:["Reticulating comment splines...","Downloading hot takes from the cloud...","Harvesting fresh opinions...","Summoning the comment spirits...","Deploying YouTube API ninjas...","Gathering digital discourse...","Extracting text vibes from the matrix..."],analyzing_sentiment:["Calibrating emotional sensors...","Teaching AI about human feelings...","Decoding sentiment wavelengths...","Consulting the vibe oracle...","Computing emotional algorithms...","Analyzing the mood spectrum...","Processing digital emotions...","Calculating happiness quotients...","Measuring sentiment particles..."],generating_summary:["Crafting wisdom from chaos...","Distilling comment essence...","Generating insight crystals...","Compiling the final verdict...","Preparing your custom report...","Assembling thought molecules...","Weaving the narrative tapestry..."]},W=["Did you know? The average YouTube comment is 27 words long!","Fun fact: 70% of YouTube comments are positive or neutral!","YouTube gets over 500 hours of video uploaded every minute!","The first YouTube comment ever was 'Interesting...' in 2005!","Comments with emojis get 33% more engagement! 😊","YouTube comments support over 75 languages worldwide!","The most liked YouTube comment has over 4 million likes!","Did you know? Comments peak within the first 2 hours of upload!","YouTube's algorithm considers comment sentiment for recommendations!"];return()=>{window.submitFeedback=void 0,window.showLoginPrompt=void 0,window.showProUpgradePrompt=void 0,window.startSentimentAnalysis=void 0,A&&clearInterval(A),w&&clearInterval(w),x&&clearInterval(x),S&&cancelAnimationFrame(S),Object.values($).forEach(e=>{try{e.destroy()}catch{}})}},[]),null}function ke(b="react-analyze-root"){const v=document.getElementById(b);if(!v)return;Ce(v).render(Ee.jsx(_e,{}))}if(typeof window<"u"){const b=()=>{document.getElementById("react-analyze-root")&&ke("react-analyze-root")};document.readyState==="loading"?window.addEventListener("DOMContentLoaded",b):b()}
